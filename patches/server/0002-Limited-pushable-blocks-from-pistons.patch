From 3adad5e566189095e64000e74bac023417da96f3 Mon Sep 17 00:00:00 2001
From: JOO200 <github@joo200.de>
Date: Sat, 7 Mar 2020 22:53:11 +0100
Subject: [PATCH] Limited pushable blocks from pistons

Optimized paper config option
---
 src/main/java/com/destroystokyo/paper/PaperConfig.java | 5 +++++
 src/main/java/net/minecraft/server/Block.java          | 4 ++++
 2 files changed, 9 insertions(+)

diff --git a/src/main/java/com/destroystokyo/paper/PaperConfig.java b/src/main/java/com/destroystokyo/paper/PaperConfig.java
index 6916ed30c..9225c79b7 100644
--- a/src/main/java/com/destroystokyo/paper/PaperConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperConfig.java
@@ -428,4 +428,9 @@ public class PaperConfig {
             */
         }
     }
+
+    public static List<String> blockedPistonBlocks = java.util.Collections.emptyList();
+    private static void blockedPistonBlocks() {
+        blockedPistonBlocks = config.getStringList("blockedPistonMaterials");
+    }
 }
diff --git a/src/main/java/net/minecraft/server/Block.java b/src/main/java/net/minecraft/server/Block.java
index e40375b67..fa7312b9d 100644
--- a/src/main/java/net/minecraft/server/Block.java
+++ b/src/main/java/net/minecraft/server/Block.java
@@ -596,6 +596,10 @@ public class Block implements IMaterial {
 
     @Deprecated
     public EnumPistonReaction getPushReaction(IBlockData iblockdata) {
+        // TerraPaper -- start block materials
+        if(com.destroystokyo.paper.PaperConfig.blockedPistonBlocks.contains(k())) return EnumPistonReaction.BLOCK;
+        // TerraPaper -- end
+
         return this.material.getPushReaction();
     }
 
-- 
2.24.1.windows.2

